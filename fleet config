go to fleet create agent policy give some name and create 
now go to agent policy and add elastic defender -> add - give name - save
add integration -> windows -> give name save

now go to agent and click add agent select the policy name u create now copy command for window -> go to windows vm and open powershell as admin and change to downloads and run commands one by one
if error then download agent manully and then run command after unzip



Windows_Server-2022-English-Full-Base-2024.06.13
ami-04df9ee4d3dfde202

sudo elastic-agent enroll --url=https://52.86.158.88:8220 --enrollment-token=QTdST1k1QUJsU2UyWWVGaWtMb0E6YzlHZDNzMkdRSDJFY1dlMktPbkxRUQ==  --insecure

insecure is imp wiothout tls we are sending

curl -L -O https://artifacts.elastic.co/downloads/beats/elastic-agent/elastic-agent-8.14.1-amd64.deb
sudo dpkg -i elastic-agent-8.14.1-amd64.deb
sudo systemctl enable elastic-agent 
sudo systemctl start elastic-agent

sudo elastic-agent enroll --url=https://172.31.43(private ip cloud).68:8220 --enrollment-token=ajhRTVpKQUJhaEJMUklKVzJHLTg6dGM0MEkxc3JSOWFqRFU5cHR3emxxQQ== --insecure(this command should be last dont forget very impoirtant)